(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-60d709b4"],{"10fd":function(e,t,a){"use strict";a.d(t,"b",(function(){return r})),a.d(t,"d",(function(){return n})),a.d(t,"c",(function(){return s})),a.d(t,"a",(function(){return o}));a("28a5"),a("6b54");function r(e){var t=/^(?:(?:1[0-9][0-9]\.)|(?:2[0-4][0-9]\.)|(?:25[0-5]\.)|(?:[1-9][0-9]\.)|(?:[0-9]\.)){3}(?:(?:1[0-9][0-9])|(?:2[0-4][0-9])|(?:25[0-5])|(?:[1-9][0-9])|(?:[0-9]))$/;return t.test(e)}function n(e){var t=/^[1][3,4,5,7,8][0-9]{9}$/;return t.test(e)}function s(e){var t=/^[1-9]+\d*$/;return t.test(e)}function o(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:9999,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e<=t&&e>=a&&-1===e.indexOf(".")}},"1ff1":function(e,t,a){"use strict";a.r(t);var r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"dooya-container"},[a("Card",[a("div",{staticStyle:{margin:"10px 0"}},[a("Button",{attrs:{type:"success",icon:"md-add"},on:{click:e.insert}},[e._v("新增用户")])],1),a("Table",{attrs:{data:e.tableData,loading:e.tableLoading,columns:e.tableColumns,stripe:""}}),a("div",{staticStyle:{margin:"10px",overflow:"hidden"}},[a("div",{staticStyle:{float:"right"}},[a("Page",{attrs:{"show-sizer":"",total:e.tableDataOrg.length,current:1},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)])],1),a("Modal",{attrs:{"mask-closable":!1,closable:!1,"footer-hide":"",title:"账号详情"},on:{"on-ok":e.handleSubmit},model:{value:e.modalShow,callback:function(t){e.modalShow=t},expression:"modalShow"}},[a("Form",{ref:"formModalData",attrs:{model:e.modalData,rules:e.formModalRule,"label-width":100},nativeOn:{submit:function(e){e.preventDefault()}}},[a("FormItem",{attrs:{label:"账号：",prop:"user_name"}},[a("Input",{attrs:{type:"text"},model:{value:e.modalData.user_name,callback:function(t){e.$set(e.modalData,"user_name","string"===typeof t?t.trim():t)},expression:"modalData.user_name"}})],1),a("FormItem",{attrs:{label:"姓名：",prop:"display_name"}},[a("Input",{attrs:{type:"text"},model:{value:e.modalData.display_name,callback:function(t){e.$set(e.modalData,"display_name","string"===typeof t?t.trim():t)},expression:"modalData.display_name"}})],1),a("FormItem",{attrs:{label:"手机号：",prop:"user_phone"}},[a("Input",{attrs:{type:"text"},model:{value:e.modalData.user_phone,callback:function(t){e.$set(e.modalData,"user_phone","string"===typeof t?t.trim():t)},expression:"modalData.user_phone"}})],1),a("FormItem",{attrs:{label:"用户组：",prop:"group_id"}},[a("Select",{model:{value:e.modalData.group_id,callback:function(t){e.$set(e.modalData,"group_id",t)},expression:"modalData.group_id"}},e._l(e.userGroup,(function(t){return a("Option",{key:t.group_id,attrs:{value:t.group_id}},[e._v(e._s(t.group_name))])})),1)],1),a("FormItem",{attrs:{label:"角色：",prop:"userAccess"}},[a("Select",{on:{"on-change":e.accessOnChange},model:{value:e.modalData.user_access,callback:function(t){e.$set(e.modalData,"user_access",t)},expression:"modalData.user_access"}},[a("Option",{attrs:{value:"admin",disabled:"admin"!==e.userAccess[0]}},[e._v("管理员")]),a("Option",{attrs:{value:"factor",disabled:"admin"!==e.userAccess[0]&&"factor"!==e.userAccess[0]}},[e._v("工程师")]),a("Option",{attrs:{value:"workshop_manager",disabled:"proline_leader"===e.userAccess[0]||"examine"===e.userAccess[0]}},[e._v("车间主管")]),a("Option",{attrs:{value:"proline_leader",disabled:"examine"===e.userAccess[0]}},[e._v("产线线长")]),a("Option",{attrs:{value:"examine"}},[e._v("检测员")])],1)],1),a("FormItem",[a("Button",{attrs:{type:"primary",loading:e.buttonLoading},on:{click:function(t){return e.handleSubmit("formModalData")}}},[e._v("确定")]),a("Button",{staticStyle:{"margin-left":"8px"},on:{click:function(t){return e.handleReset("formModalData")}}},[e._v("取消")])],1)],1)],1)],1)},n=[],s=(a("8e6e"),a("456d"),a("ac6a"),a("6b54"),a("96cf"),a("3b8d")),o=a("bd86"),i=a("fab29"),c=a("66df"),u=function(){return c["a"].request({url:"/api/userGroup/getUseGroupList",method:"get"})},l=a("10fd"),d=a("2f62");function p(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,r)}return a}function m(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?p(Object(a),!0).forEach((function(t){Object(o["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):p(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var g={data:function(){var e=this;return{tableDataOrg:[],tableData:[],tableColumns:[{title:"账号",key:"user_name",align:"center",minWidth:120},{title:"姓名",key:"display_name",align:"center",minWidth:120},{title:"电话",key:"user_phone",align:"center",minWidth:120},{title:"角色",key:"userAccess",align:"center",render:function(e,t){return e("div","admin"===t.row.userAccess?"管理员":"factor"===t.row.userAccess?"工程师":"workshop_manager"===t.row.userAccess?"车间主管":"proline_leader"===t.row.userAccess?"产线线长":"检测员")},minWidth:120},{title:"操作",key:"action",fixed:"right",minWidth:180,align:"center",render:function(t,a){return t("div",[t("Tooltip",{props:{trigger:"hover",content:"修改",placement:"top",transfer:!0}},[t("Button",{props:{type:"primary",size:"small",icon:"ios-create-outline"},style:{marginRight:"5px"},on:{click:function(){e.edit(a.row)}}})]),t("Tooltip",{props:{trigger:"hover",content:"0"===a.row.lock_flag?"锁定":"解锁",placement:"top",transfer:!0}},[t("Button",{props:{type:"warning",size:"small",icon:"0"===a.row.lock_flag?"ios-key-outline":"ios-key"},style:{marginRight:"5px"},on:{click:function(){e.lock(a.row)}}})]),t("Tooltip",{props:{trigger:"hover",content:"删除",placement:"top",transfer:!0}},[t("Button",{props:{type:"error",size:"small",icon:"md-close"},on:{click:function(){e.delete(a.row)}}})])])}}],tableLoading:!1,buttonLoading:!1,pageNum:1,pageSize:10,modalShow:!1,modalData:{user_phone:null},formModalRule:{user_name:[{required:!0,message:"请输入账户名",trigger:"change"},{type:"string",max:20,message:"账户名过长",trigger:"change"}],display_name:[{required:!0,message:"请输入姓名",trigger:"change"},{type:"string",max:10,message:"姓名过长",trigger:"change"}],user_phone:[{required:!0,trigger:"change",validator:function(e,t,a){Object(l["d"])(t)||""===t?a():a(new Error("手机号格式不正确"))}}],group_id:[{required:!0,message:"请选择用户组",trigger:"change"}],userAccess:[{required:!0,validator:function(e,t,a){""===t?a(new Error("请选择用户角色")):a()},message:"请选择用户角色",trigger:"change"}]},userGroup:[],modalDataType:""}},computed:m({},Object(d["c"])(["userAccess"])),created:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.getData(),e.next=3,u();case 3:this.userGroup=e.sent.data.data;case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),methods:{getData:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.tableLoading=!0,e.next=3,Object(i["c"])();case 3:this.tableDataOrg=e.sent.data.data,this.refreshData(),this.buttonLoading=!1,this.tableLoading=!1;case 7:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),refreshData:function(){this.tableData=this.tableDataOrg.slice((this.pageNum-1)*this.pageSize,this.pageNum*this.pageSize)},changePage:function(e){this.pageNum=e,this.refreshData()},changePageSize:function(e){this.pageSize=e,this.refreshData()},insert:function(){this.modalDataType="insert",this.modalData={},this.modalData.user_access=["examine"],this.modalData.user_phone="",this.modalShow=!0},edit:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.isMock?(this.modalDataType="edit",this.modalData=JSON.parse(JSON.stringify(t)),this.modalData.group_id="开发组"===this.modalData.group_name?"001":"002",this.modalShow=!0):(this.modalDataType="edit",this.modalData=JSON.parse(JSON.stringify(t)),this.modalShow=!0);case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),accessOnChange:function(e){this.modalData.userAccess=e,this.modalData.user_access=[this.modalData.user_access]},handleSubmit:function(){var e=this;this.$refs.formModalData.validate(function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(a){var r,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!a){t.next=39;break}e.buttonLoading=!0,t.t0=e.modalDataType,t.next="insert"===t.t0?5:"edit"===t.t0?23:39;break;case 5:if(e.isMock){t.next=15;break}return e.modalData.user_avator="",t.next=9,Object(i["d"])(e.modalData);case 9:r=t.sent.data.status,200===r&&(e.$refs.formModalData.resetFields(),e.$Message.success("添加成功！")),e.modalShow=!1,e.getData(),t.next=22;break;case 15:e.modalData.group_name="001"===e.modalData.group_id?"开发组":"产品组",e.modalData.user_id=(e.tableDataOrg.length+1).toString(),e.tableDataOrg.push(e.modalData),e.refreshData(),e.$Message.success("添加成功！"),e.buttonLoading=!1,e.modalShow=!1;case 22:return t.abrupt("break",39);case 23:if(e.isMock){t.next=33;break}return e.modalData.user_avator="",t.next=27,Object(i["e"])(e.modalData);case 27:n=t.sent.data.status,200===n&&(e.$refs.formModalData.resetFields(),e.$Message.success("修改成功！")),e.modalShow=!1,e.getData(),t.next=38;break;case 33:e.tableData.forEach((function(t){e.modalData.user_id===t.user_id&&e.$set(t,"group_name","001"===e.modalData.group_id?"开发组":"产品组")})),e.refreshData(),e.$Message.success("修改成功！"),e.buttonLoading=!1,e.modalShow=!1;case 38:return t.abrupt("break",39);case 39:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())},handleReset:function(){this.$refs.formModalData.resetFields(),this.modalShow=!1},lock:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(t){var a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.lock_flag="0"===t.lock_flag?"1":"0",this.isMock){e.next=8;break}return e.next=4,Object(i["e"])(t);case 4:a=e.sent.data.status,200===a&&this.$Message.success("1"===t.lock_flag?"锁定成功！":"解锁成功！"),e.next=9;break;case 8:this.$Message.success(1===t.lock_flag?"锁定成功！":"解锁成功！");case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),delete:function(e){var t=this;this.$Modal.confirm({title:"确定删除该用户？",onOk:function(){var a=Object(s["a"])(regeneratorRuntime.mark((function a(){var r;return regeneratorRuntime.wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(t.isMock){a.next=8;break}return a.next=3,Object(i["a"])(e.user_id);case 3:r=a.sent.data.status,200===r&&t.$Message.success("删除成功"),t.getData(),a.next=11;break;case 8:t.tableData.forEach((function(a){if(e.user_id===a.user_id){var r=t.tableDataOrg.indexOf(a);t.tableDataOrg.splice(r,1)}})),t.$Message.success("删除成功"),t.refreshData();case 11:case"end":return a.stop()}}),a)})));function r(){return a.apply(this,arguments)}return r}(),closable:!0})}}},h=g,f=a("2877"),b=Object(f["a"])(h,r,n,!1,null,"32398ff6",null);t["default"]=b.exports}}]);