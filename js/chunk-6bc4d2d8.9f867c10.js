(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6bc4d2d8"],{"0410":function(t,e,s){"use strict";var i=s("ccd4"),a=s.n(i);a.a},"1c3c":function(t,e,s){"use strict";s.r(e);var i=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"control-container",attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[i("img",{staticClass:"control-container-header",attrs:{src:s("0f51")}}),i("table"),i("div",{staticClass:"control-container-title"},[i("h2",{on:{click:t.backRouter}},[t._v("车间驾驶舱")])]),i("div",{staticClass:"control-container-inner"},[i("Row",{attrs:{gutter:20}},[i("Col",{staticClass:"col-left",style:{height:parseInt(t.colBlockHeight)+20+"px"},attrs:{xs:24,sm:24,md:8,xl:6}},[i("ul",{style:1==t.animate?t.animStyle:""},t._l(t.alertList,(function(e,s){return i("li",{key:s,staticClass:"col-block col-block-min col-block-min-alert",style:{height:t.colBlockMinHeight},on:{mouseenter:t.alertEnter,mouseleave:t.alertLeave}},[i("div",{staticClass:"col-block-title left"},[t._v("\n            "+t._s(""!==t.alertList[0].LineNo?"预警："+e.LineNo+"#产线":"暂无预警")+"\n          ")]),i("div",{staticClass:"col-block-chart"},[i("lineChart",{style:{height:parseInt(t.colBlockMinHeight)-70+"px"},attrs:{chartData:e.chartData,standardValue:e.AverageCount||20,yAxisMaxValue:e.AverageCount+5||30,unit:"件"}})],1)])})),0)]),i("Col",{attrs:{xs:24,sm:24,md:16,xl:12}},[i("div",{ref:"colBlockLarge",staticClass:"col-block col-block-large",style:{height:t.colBlockLargeHeight}},[i("div",{staticClass:"col-block-title"},[t._v("\n          检测总览\n        ")]),i("div",{staticClass:"col-block-chart whole",style:{height:parseInt(t.colBlockLargeHeight)-70+"px",padding:t.screenHeight>900?"2% 0":"1% 0"}},t._l(t.todayList,(function(e,s){return i("div",{key:s,staticClass:"MainBlock",style:{padding:t.screenHeight>1e3?"20px 0":t.screenHeight>800?"10px 0":"0"}},[i("div",{staticClass:"MainBlock-title"},[t._v(t._s(e.ProductClass))]),i("span",{staticClass:"MainBlock-title-block-small"},[t._v("目标")]),i("span",{staticClass:"MainBlock-title-block-huge"},[t._v(t._s(e.TaskCount))]),i("span",{staticClass:"MainBlock-title-block-small"},[t._v("台")]),i("span",{staticClass:"MainBlock-title-block-small"},[t._v("/")]),i("span",{staticClass:"MainBlock-title-block-small"},[t._v("完成")]),i("span",{staticClass:"MainBlock-title-block-huge"},[t._v(t._s(e.QualifiedCount))]),i("span",{staticClass:"MainBlock-title-block-small"},[t._v("台")]),i("span",{staticClass:"MainBlock-title-block-small"}),i("span",{staticClass:"MainBlock-title-block",staticStyle:{"vertical-align":"bottom"}},[i("i-circle",{attrs:{percent:e.CompletedRate,"stroke-color":100===e.CompletedRate?"#5cb85c":e.CompletedRate>=60?"#2db7f5":"#ff5500",size:70}},[i("span",{staticClass:"demo-Circle-inner",staticStyle:{"font-size":"1.2em",color:"#fff"}},[i("p",{staticStyle:{"line-height":"1.3em"}},[t._v("达成率")]),t._v("\n                  "+t._s(e.CompletedRate)+"%\n                ")])])],1)])})),0)]),i("Row",{attrs:{gutter:20}},[i("Col",{attrs:{xs:24,sm:24,md:12,xl:12}},[i("div",{staticClass:"col-block col-block-min col-block-min-mid",style:{height:t.colBlockMidHeight}},[i("div",{staticClass:"col-block-title"},[t._v("\n            生产任务\n          ")]),i("div",{staticClass:"col-block-chart"},[i("pieChart",{style:{height:parseInt(t.colBlockMidHeight)-70+"px"},attrs:{chartData:t.todayAssign.proAssign,legendData:t.todayAssign.legendDataAssign||["A型","B型","R型","SS型"],seriesCenter:["60%","50%"]}})],1)])]),i("Col",{attrs:{xs:24,sm:24,md:12,xl:12}},[i("div",{staticClass:"col-block col-block-min col-block-min-mid",style:{height:t.colBlockMidHeight}},[i("div",{staticClass:"col-block-title"},[t._v("\n            产线概况\n          ")]),i("div",{staticClass:"col-block-chart"},[i("pieChart",{style:{height:parseInt(t.colBlockMidHeight)-70+"px"},attrs:{chartData:t.todayAssign.proLine,color:["#32ce32","#fc8a53","#2db7f5"],legendData:["生产中","预警","未生产"],seriesCenter:["60%","50%"],unit:"台"}})],1)])])],1)],1),i("Col",{attrs:{xs:24,sm:24,md:24,xl:6}},[i("div",{staticClass:"col-block col-block-min",style:{height:t.colBlockHeight}},[i("div",{staticClass:"col-block-title"},[t._v("\n          今日各产线概况\n        ")]),i("div",{staticClass:"col-block-chart",staticStyle:{background:"transparent"}},[i("Row",{staticClass:"col-block-chart-row",style:{height:parseInt(t.colBlockHeight)-70+"px",padding:"0"},attrs:{gutter:15}},t._l(t.todayPro,(function(e,s){return i("Col",{key:s,staticClass:"col-block-chart-box",attrs:{xs:24,sm:24,md:12,xl:24}},[i("div",{staticClass:"BoxWrap",style:{height:t.proBlockHeight},on:{click:function(e){return t.proHandleClick(s)}}},[i("div",{staticClass:"horn"},[i("div",{staticClass:"lt"}),i("div",{staticClass:"rt"}),i("div",{staticClass:"rb"}),i("div",{staticClass:"lb"})]),i("table"),i("div",{staticClass:"BoxWrap-title"},[i("Tag",{staticStyle:{padding:"0 5px"},attrs:{color:e.IsWarning?"error":"success"}},[t._v("\n                  "+t._s(e.IsWarning?"预警":"正常")+"\n                ")]),t._v("\n                 "+t._s(e.LineNo)+"# "+t._s(e.captain)+" "+t._s(e.captionPhone)+"\n              ")],1),i("div",{staticClass:"BoxWrap-block"},[i("p",{staticClass:"BoxWrap-block-num"},[t._v("\n                  "+t._s(t.isMock?e.ProductClass:e.ProductClass.substring(0,e.ProductClass.length-2))+"\n                ")]),i("p",[t._v("\n                  型号\n                ")])]),i("div",{staticClass:"BoxWrap-block"},[i("p",{staticClass:"BoxWrap-block-num"},[t._v("\n                  "+t._s(e.TaskCount)+"件\n                ")]),i("p",[t._v("\n                  任务量\n                ")])]),i("div",{staticClass:"BoxWrap-block"},[i("p",{staticClass:"BoxWrap-block-num"},[t._v("\n                  "+t._s(e.QualifiedCount)+"件\n                ")]),i("p",[t._v("\n                  达成量\n                ")])]),i("div",{staticClass:"BoxWrap-block"},[i("p",{staticClass:"BoxWrap-block-num"},[t._v("\n                  "+t._s(e.CompletedRate)+"%\n                ")]),i("p",[t._v("\n                  达成率\n                ")])]),i("div",{staticClass:"BoxWrap-block"},[i("p",{staticClass:"BoxWrap-block-num"},[t._v("\n                  "+t._s(e.QualifiedRate)+"%\n                ")]),i("p",[t._v("\n                  良品率\n                ")])])])])})),1)],1)])])],1)],1)])},a=[],n=(s("8e6e"),s("456d"),s("ac6a"),s("6b54"),s("96cf"),s("3b8d")),o=s("bd86"),c=s("11e7"),l=s("5f43"),r=s("e2d4"),h=s("76d7"),u=s("2f62");function d(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,i)}return s}function p(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?d(Object(s),!0).forEach((function(e){Object(o["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):d(Object(s)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var g={components:{lineChart:c["a"],pieChart:l["a"]},data:function(){return{screenHeight:0,colBlockMinHeight:"0px",colBlockLargeHeight:"0px",colBlockMidHeight:"0px",colBlockHeight:"0px",proBlockHeight:"0px",alertList:[],todayPro:[],todayList:[],todayAssign:[],animate:!1,animStyle:{transition:"all .5s",marginTop:""},timer:""}},computed:p({},Object(u["c"])(["userAccess"])),mounted:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.getHeight(),window.onresize=function(){return function(){e.getHeight()}()},window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.goBack,!1));case 3:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),created:function(){this.getData(),this.alertList.length>3&&(this.timer=setInterval(this.scroll,3e3))},destroyed:function(){window.removeEventListener("popstate",this.goBack,!1)},methods:{scroll:function(){var t=this;this.animate=!0,setTimeout((function(){t.alertList.push(t.alertList[0]),t.alertList.shift(),t.animate=!1}),500)},getHeight:function(){this.screenHeight=document.body.clientHeight;var t=80;this.colBlockMinHeight=(this.screenHeight-t-40-60)/3+"px",this.colBlockLargeHeight=2*(this.screenHeight-t-40-40)/3+"px",this.colBlockMidHeight=1*(this.screenHeight-t-40-40)/3+"px",this.colBlockHeight=this.screenHeight-t-40-20+"px",this.proBlockHeight=this.screenHeight/8+"px",this.animStyle.marginTop="-"+(parseInt(this.colBlockMinHeight)+20)+"px"},getData:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:this.isMock?(this.alertList=r["a"],this.todayPro=r["h"],this.todayList=r["g"],this.todayAssign=r["f"]):(this.client=h["b"].connect(h["a"],h["c"]),this.client.on("connect",(function(t){e.client.subscribe("ProductRoom",{qos:1},(function(t){}))})),this.client.on("message",(function(t,s){var i=JSON.parse(s.toString());console.log(i),i.ProductClassOverview.forEach((function(t){e.$set(t,"CompletedRate",parseInt(1e4*t.CompletedRate)/100)})),e.todayList=i.ProductClassOverview;var a=[];i.ProductClassTask.forEach((function(t){e.$set(t,"value",t.TaskCount),e.$set(t,"name",t.ProductClass),a.push(t.ProductClass)}));var n=[];Object.keys(i.LineStatuOverview).forEach((function(t){n.push({name:"NormalCount"===t?"生产中":"WaringCount"===t?"预警":"未生产",value:i.LineStatuOverview[t]})})),e.todayAssign={proAssign:i.ProductClassTask,proLine:n,legendDataAssign:a},0!==i.LineWorkingTimeWarning.length?(i.LineWorkingTimeWarning.forEach((function(t){var s=[],i=[];t.WorkInfo.forEach((function(t){s.push(t.StartTime.substring(0,t.StartTime.length-3)),i.push(t.CompleteCount)})),e.$set(t,"chartData",{xAxisData:s,seriesData:i})})),e.alertList=i.LineWorkingTimeWarning):e.alertList=[{LineNo:"",chartData:{xAxisData:[],seriesData:[]}}],e.todayPro=i.LineOverviewReport})));case 1:case"end":return t.stop()}}),t,this)})));function e(){return t.apply(this,arguments)}return e}(),backRouter:function(){-1!==this.userAccess.indexOf("workshop_manager")&&this.$router.push({name:this.$config.homeName})},alertEnter:function(){clearInterval(this.timer)},alertLeave:function(){this.alertList.length>3&&(this.timer=setInterval(this.scroll,3e3))},proHandleClick:function(t){clearInterval(this.timer),this.isMock||this.client.end(),this.$router.push({path:"/control-leader-line",name:"control-leader-line",query:{lineNo:this.todayPro[t].LineNo}})},goBack:function(){sessionStorage.clear(),window.history.back(),this.isMock||this.client.end(),clearInterval(this.timer)}}},k=g,v=(s("0410"),s("2877")),m=Object(v["a"])(k,i,a,!1,null,"4d7f292d",null);e["default"]=m.exports},ccd4:function(t,e,s){}}]);