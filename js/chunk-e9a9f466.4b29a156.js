(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-e9a9f466"],{1218:function(e,t,a){},aab5:function(e,t,a){"use strict";var i=a("1218"),s=a.n(i);s.a},d7db:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{staticClass:"control-container",attrs:{"element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[i("img",{staticClass:"control-container-header",attrs:{src:a("0f51")}}),i("table"),i("div",{staticClass:"control-container-title"},[i("h2",{on:{click:e.backRouter}},[e._v(e._s(e.lineNo)+"号产线")])]),i("div",{staticClass:"control-container-inner"},[i("Row",{attrs:{gutter:20}},[i("Col",{staticClass:"col-left",attrs:{xs:24,sm:24,md:8,xl:6}},[i("ul",e._l(e.lineCompletedRate,(function(t,a){return i("li",{key:a,staticClass:"col-block col-block-min",style:{height:e.colBlockMinHeight}},[i("div",{staticClass:"col-block-title left"},[e._v("\n            达成率："+e._s(t.process)+"\n          ")]),i("div",{staticClass:"col-block-chart"},[0!==t.chartData.xAxisData.length?i("lineChart",{style:{height:parseInt(e.colBlockMinHeight)-70+"px"},attrs:{chartData:t.chartData,standardValue:t.standardValue||80}}):i("div",{staticClass:"no-data",style:{height:parseInt(e.colBlockMinHeight)-70+"px"}},[i("div",{staticClass:"content"},[e._v("当前未生产")])])],1)])})),0)]),i("Col",{attrs:{xs:24,sm:24,md:16,xl:12}},[i("div",{ref:"colBlockLarge",staticClass:"col-block col-block-large",style:{height:e.colBlockLargeHeight}},[i("div",{staticClass:"col-block-title"},[e._v("\n          产线总览\n        ")]),i("div",{staticClass:"col-block-chart whole",style:{height:parseInt(e.colBlockLargeHeight)-70+"px",padding:e.screenHeight>900?"2% 0":"1% 0"}},e._l(e.lineProcessData,(function(t,a){return i("div",{key:a,staticClass:"MainBlock",style:{padding:e.screenHeight>1e3?"20px 0":e.screenHeight>800?"10px 0":"0"}},[i("div",{staticClass:"MainBlock-title",staticStyle:{width:"100px"}},[e._v(e._s(t.process))]),i("span",{staticClass:"MainBlock-title-block-small"},[e._v("检测数")]),i("span",{staticClass:"MainBlock-title-block-huge"},[e._v(e._s(t.totalNum))]),i("span",{staticClass:"MainBlock-title-block-small"},[e._v("台")]),i("span",{staticClass:"MainBlock-title-block-small"},[e._v("/")]),i("span",{staticClass:"MainBlock-title-block-small"},[e._v("良品数")]),i("span",{staticClass:"MainBlock-title-block-huge"},[e._v(e._s(t.completeNum))]),i("span",{staticClass:"MainBlock-title-block-small"},[e._v("台")]),i("span",{staticClass:"MainBlock-title-block-small"}),i("span",{staticClass:"MainBlock-title-block",staticStyle:{"vertical-align":"bottom"}},[i("i-circle",{staticStyle:{"margin-right":"10px"},attrs:{percent:t.completeRate,"stroke-color":100===t.completeRate?"#5cb85c":t.completeRate>=60?"#2db7f5":"#ff5500",size:70}},[i("span",{staticClass:"demo-Circle-inner",staticStyle:{"font-size":"1.2em",color:"#fff"}},[i("p",{staticStyle:{"line-height":"1.3em"}},[e._v("达成率")]),e._v("\n                  "+e._s(t.completeRate)+"%\n                ")])]),i("i-circle",{attrs:{percent:t.qualifiedRate,"stroke-color":100===t.qualifiedRate?"#5cb85c":t.qualifiedRate>=60?"#2db7f5":"#ff5500",size:70}},[i("span",{staticClass:"demo-Circle-inner",staticStyle:{"font-size":"1.2em",color:"#fff"}},[i("p",{staticStyle:{"line-height":"1.3em"}},[e._v("良品率")]),e._v("\n                  "+e._s(t.qualifiedRate)+"%\n                ")])])],1)])})),0)]),i("Row",{attrs:{gutter:20}},[i("Col",{attrs:{xs:24,sm:24,md:8,xl:8}},[i("div",{staticClass:"col-block col-block-min col-block-min-mid",style:{height:e.colBlockMidHeight}},[i("div",{staticClass:"col-block-title"},[e._v("\n            今日异常：综合检测\n          ")]),i("div",{staticClass:"col-block-chart"},[0!==e.pieUnqalifiedReason.qc1.length?i("pieChart",{style:{height:parseInt(e.colBlockMidHeight)-70+"px"},attrs:{chartData:e.qc1PieData}}):i("div",{staticClass:"no-data",style:{height:parseInt(e.colBlockMidHeight)-70+"px"}},[i("div",{staticClass:"content"},[e._v("未检测异常")])])],1)])]),i("Col",{attrs:{xs:24,sm:24,md:8,xl:8}},[i("div",{staticClass:"col-block col-block-min col-block-min-mid",style:{height:e.colBlockMidHeight}},[i("div",{staticClass:"col-block-title"},[e._v("\n            今日异常：静音检测\n          ")]),i("div",{staticClass:"col-block-chart"},[0!==e.pieUnqalifiedReason.qc2.length?i("pieChart",{style:{height:parseInt(e.colBlockMidHeight)-70+"px"},attrs:{chartData:e.qc2PieData}}):i("div",{staticClass:"no-data",style:{height:parseInt(e.colBlockMidHeight)-70+"px"}},[i("div",{staticClass:"content"},[e._v("未检测异常")])])],1)])]),i("Col",{attrs:{xs:24,sm:24,md:8,xl:8}},[i("div",{staticClass:"col-block col-block-min col-block-min-mid",style:{height:e.colBlockMidHeight}},[i("div",{staticClass:"col-block-title"},[e._v("\n            今日异常：外观检测\n          ")]),i("div",{staticClass:"col-block-chart"},[0!==e.pieUnqalifiedReason.qc3.length?i("pieChart",{style:{height:parseInt(e.colBlockMidHeight)-70+"px"},attrs:{chartData:e.qc3PieData}}):i("div",{staticClass:"no-data",style:{height:parseInt(e.colBlockMidHeight)-70+"px"}},[i("div",{staticClass:"content"},[e._v("未检测异常")])])],1)])])],1)],1),i("Col",{attrs:{xs:24,sm:24,md:24,xl:6}},[i("ul",e._l(e.lineQualifiedRate,(function(t,a){return i("li",{key:a,staticClass:"col-block col-block-min",style:{height:e.colBlockMinHeight}},[i("div",{staticClass:"col-block-title left"},[e._v("\n            良品率："+e._s(t.process)+"\n          ")]),i("div",{staticClass:"col-block-chart"},[0!==t.chartData.xAxisData.length?i("lineChart",{style:{height:parseInt(e.colBlockMinHeight)-70+"px"},attrs:{chartData:t.chartData,standardValue:t.standardValue||80}}):i("div",{staticClass:"no-data",style:{height:parseInt(e.colBlockMinHeight)-70+"px"}},[i("div",{staticClass:"content"},[e._v("当前未生产")])])],1)])})),0)])],1)],1)])},s=[],c=(a("7f7f"),a("55dd"),a("ac6a"),a("6b54"),a("96cf"),a("3b8d")),n=a("0c70"),l=a("f11f"),o=a("11e7"),r=a("5f43"),h=a("e2d4"),d=a("76d7"),p={components:{lineChart:o["a"],pieChart:r["a"]},data:function(){return{lineNo:"",screenHeight:0,colBlockMinHeight:"0px",colBlockLargeHeight:"0px",colBlockMidHeight:"0px",lineCompletedRate:[{process:"综合检测",chartData:{xAxisData:[],seriesData:[]}},{process:"综合检测",chartData:{xAxisData:[],seriesData:[]}},{process:"综合检测",chartData:{xAxisData:[],seriesData:[]}}],lineQualifiedRate:[{process:"综合检测",chartData:{xAxisData:[],seriesData:[]}},{process:"综合检测",chartData:{xAxisData:[],seriesData:[]}},{process:"综合检测",chartData:{xAxisData:[],seriesData:[]}}],pieUnqalifiedReason:{qc1:[],qc2:[],qc3:[]},lineProcessData:[],qc1PieData:[],qc2PieData:[],qc3PieData:[],client:null}},mounted:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.getHeight(),window.onresize=function(){return function(){t.getHeight()}()},window.history&&window.history.pushState&&(history.pushState(null,null,document.URL),window.addEventListener("popstate",this.goBack,!1));case 3:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),created:function(){void 0!==this.$route.query.lineNo?this.lineNo=this.$route.query.lineNo:this.lineNo=Object(n["a"])(this,"loginLineNo"),this.getData()},destroyed:function(){window.removeEventListener("popstate",this.goBack,!1)},methods:{getHeight:function(){this.screenHeight=document.body.clientHeight;var e=80;this.colBlockMinHeight=(this.screenHeight-e-40-60)/3+"px",this.colBlockLargeHeight=2*(this.screenHeight-e-40-40)/3+"px",this.colBlockMidHeight=1*(this.screenHeight-e-40-40)/3+"px"},getData:function(){var e=Object(c["a"])(regeneratorRuntime.mark((function e(){var t,a,i,s=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:this.isMock?(this.lineCompletedRate=h["b"],this.lineQualifiedRate=h["d"],this.pieUnqalifiedReason=h["e"],this.lineProcessData=h["c"],this.pieUnqalifiedReason.qc1.length>4?(this.pieUnqalifiedReason.qc1.sort(Object(l["b"])("value","desc")),t=[this.pieUnqalifiedReason.qc1[0].name,this.pieUnqalifiedReason.qc1[1].name,this.pieUnqalifiedReason.qc1[2].name],this.getPieData(t,1)):this.qc1PieData=this.pieUnqalifiedReason.qc1,this.pieUnqalifiedReason.qc2.length>4?(this.pieUnqalifiedReason.qc2.sort(Object(l["b"])("value","desc")),a=[this.pieUnqalifiedReason.qc2[0].name,this.pieUnqalifiedReason.qc2[1].name,this.pieUnqalifiedReason.qc2[2].name],this.getPieData(a,2)):this.qc2PieData=this.pieUnqalifiedReason.qc2,this.pieUnqalifiedReason.qc3.length>4?(this.pieUnqalifiedReason.qc3.sort(Object(l["b"])("value","desc")),i=[this.pieUnqalifiedReason.qc3[0].name,this.pieUnqalifiedReason.qc3[1].name,this.pieUnqalifiedReason.qc3[2].name],this.getPieData(i,3)):this.qc3PieData=this.pieUnqalifiedReason.qc3):(this.client=d["b"].connect(d["a"],d["c"]),this.client.on("connect",(function(e){s.client.unsubscribe("ProductRoom");for(var t=1;t<=60;t++)s.client.unsubscribe("".concat(t,"-ProductLine"));s.client.subscribe("".concat(s.lineNo,"-ProductLine"),{qos:1},(function(e){}))})),this.client.on("message",(function(e,t){var a=JSON.parse(t.toString());console.log(e,a);var i=a.LineRateOverview;if(s.lineProcessData=[{process:"综合检测",totalNum:i.Qc1Sum,completeNum:i.Qc1Qualified,completeRate:parseInt(1e4*i.Qc1CompleteRate)/100,qualifiedRate:parseInt(1e4*i.Qc1QualifiedRate)/100},{process:"静音检测",totalNum:i.Qc2Sum,completeNum:i.Qc2Qualified,completeRate:parseInt(1e4*i.Qc2CompleteRate)/100,qualifiedRate:parseInt(1e4*i.Qc2QualifiedRate)/100},{process:"外观检测",totalNum:i.Qc3Sum,completeNum:i.Qc3Qualified,completeRate:parseInt(1e4*i.Qc3CompleteRate)/100,qualifiedRate:parseInt(1e4*i.Qc3QualifiedRate)/100}],0!==a.Qc1UnqualifiedReason.length&&a.Qc1UnqualifiedReason.forEach((function(e){s.$set(e,"value",e.Value),s.$set(e,"name",e.Key||"未归类")})),0!==a.Qc2UnqualifiedReason.length&&a.Qc2UnqualifiedReason.forEach((function(e){s.$set(e,"value",e.Value),s.$set(e,"name",e.Key||"未归类")})),0!==a.Qc3UnqualifiedReason.length&&a.Qc3UnqualifiedReason.forEach((function(e){s.$set(e,"value",e.Value),s.$set(e,"name",e.Key||"未归类")})),s.pieUnqalifiedReason={qc1:a.Qc1UnqualifiedReason||[],qc2:a.Qc2UnqualifiedReason||[],qc3:a.Qc3UnqualifiedReason||[]},s.pieUnqalifiedReason.qc1.length>4){s.pieUnqalifiedReason.qc1.sort(Object(l["b"])("value","desc"));var c=[s.pieUnqalifiedReason.qc1[0].name,s.pieUnqalifiedReason.qc1[1].name,s.pieUnqalifiedReason.qc1[2].name];s.getPieData(c,1)}else s.qc1PieData=s.pieUnqalifiedReason.qc1;if(s.pieUnqalifiedReason.qc2.length>4){s.pieUnqalifiedReason.qc2.sort(Object(l["b"])("value","desc"));var n=[s.pieUnqalifiedReason.qc2[0].name,s.pieUnqalifiedReason.qc2[1].name,s.pieUnqalifiedReason.qc2[2].name];s.getPieData(n,2)}else s.qc2PieData=s.pieUnqalifiedReason.qc2;if(s.pieUnqalifiedReason.qc3.length>4){s.pieUnqalifiedReason.qc3.sort(Object(l["b"])("value","desc"));var o=[s.pieUnqalifiedReason.qc3[0].name,s.pieUnqalifiedReason.qc3[1].name,s.pieUnqalifiedReason.qc3[2].name];s.getPieData(o,3)}else s.qc3PieData=s.pieUnqalifiedReason.qc3;var r={xAxisData:[],seriesData:[]},h={xAxisData:[],seriesData:[]},d={xAxisData:[],seriesData:[]},p={xAxisData:[],seriesData:[]},u={xAxisData:[],seriesData:[]},f={xAxisData:[],seriesData:[]};if(0!==a.LineRateDetail.length){a.LineRateDetail.forEach((function(e){r.xAxisData.push(e.EndTime.substring(0,e.EndTime.length-3)),h.xAxisData.push(e.EndTime.substring(0,e.EndTime.length-3)),d.xAxisData.push(e.EndTime.substring(0,e.EndTime.length-3)),r.seriesData.push(parseInt(1e4*e.Qc1CompleteRate)/100),h.seriesData.push(parseInt(1e4*e.Qc2CompleteRate)/100),d.seriesData.push(parseInt(1e4*e.Qc3CompleteRate)/100),p.xAxisData.push(e.EndTime.substring(0,e.EndTime.length-3)),u.xAxisData.push(e.EndTime.substring(0,e.EndTime.length-3)),f.xAxisData.push(e.EndTime.substring(0,e.EndTime.length-3)),p.seriesData.push(parseInt(1e4*e.Qc1QualifiedRate)/100),u.seriesData.push(parseInt(1e4*e.Qc2QualifiedRate)/100),f.seriesData.push(parseInt(1e4*e.Qc3QualifiedRate)/100)}));var q=parseInt(1e4*a.LineRateDetail[0].CompleteRateTask)/100;s.lineCompletedRate=[{process:"综合检测",chartData:r,standardValue:q},{process:"静音检测",chartData:h,standardValue:q},{process:"外观检测",chartData:d,standardValue:q}],s.lineQualifiedRate=[{process:"综合检测",chartData:p,standardValue:q},{process:"静音检测",chartData:u,standardValue:q},{process:"外观检测",chartData:f,standardValue:q}]}})));case 1:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getPieData:function(e,t){var a=this;switch(t){case 1:this.qc1PieData=[];var i=0;e.forEach((function(e){a.qc1PieData.push({value:Object(l["c"])(a.pieUnqalifiedReason.qc1,"name",e,"value"),name:e}),i+=Object(l["c"])(a.pieUnqalifiedReason.qc1,"name",e,"value")}));var s=Object(l["a"])(this.pieUnqalifiedReason.qc1,"value")-i;this.qc1PieData.push({value:s,name:"其他"});break;case 2:this.qc2PieData=[];var c=0;e.forEach((function(e){a.qc2PieData.push({value:Object(l["c"])(a.pieUnqalifiedReason.qc2,"name",e,"value"),name:e}),c+=Object(l["c"])(a.pieUnqalifiedReason.qc2,"name",e,"value")}));var n=Object(l["a"])(this.pieUnqalifiedReason.qc2,"value")-c;this.qc2PieData.push({value:n,name:"其他"});break;case 3:this.qc3PieData=[];var o=0;e.forEach((function(e){a.qc3PieData.push({value:Object(l["c"])(a.pieUnqalifiedReason.qc3,"name",e,"value"),name:e}),o+=Object(l["c"])(a.pieUnqalifiedReason.qc3,"name",e,"value")}));var r=Object(l["a"])(this.pieUnqalifiedReason.qc3,"value")-o;this.qc3PieData.push({value:r,name:"其他"});break}},backRouter:function(){this.isMock?this.goBack():(this.client.unsubscribe("".concat(this.lineNo,"-ProductLine")),this.client.end(!0,this.goBack()))},goBack:function(){this.isMock?(sessionStorage.clear(),window.history.back()):(this.client.unsubscribe("".concat(this.lineNo,"-ProductLine")),this.client.end(!0,sessionStorage.clear(),window.history.back()))}}},u=p,f=(a("aab5"),a("2877")),q=Object(f["a"])(u,i,s,!1,null,"57e4c48a",null);t["default"]=q.exports}}]);